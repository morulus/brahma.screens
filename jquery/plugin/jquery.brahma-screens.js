/*!
* jQuery.brahma.screens 1.2.3 (* 15-03-2015)
* Prallax fullscreen slider
* https://github.com/morulus/brahma.screens

* Released under the MIT license 
* Copyright (c) 2015, Vladimir Kalmykov (@morulus) <vladimirmorulus@gmail.com> 
*/

Object.prototype.ref=function(){function Ref(){}return Ref.prototype=this,Ref.prototype.constructor=Ref,new Ref},function(){function overrideNodeMethod(prototype,methodName){var oldMethod=prototype[methodName];prototype[methodName]=function(query){var nodeList,gaveId=!1,gaveContainer=!1;return query.match(scopeRE)?(query=query.replace(scopeRE,""),this.parentNode||(container.appendChild(this),gaveContainer=!0),parentNode=this.parentNode,this.id||(this.id="rootedQuerySelector_id_"+(new Date).getTime(),gaveId=!0),nodeList=oldMethod.call(parentNode,"#"+this.id+" "+query),gaveId&&(this.id=""),gaveContainer&&container.removeChild(this),nodeList):oldMethod.call(this,query)}}if(!HTMLElement.prototype.querySelectorAll)throw new Error("rootedQuerySelectorAll: This polyfill can only be used with browsers that support querySelectorAll");var container=document.createElement("div");try{container.querySelectorAll(":scope *")}catch(e){var scopeRE=/^\s*:scope/gi;overrideNodeMethod(HTMLElement.prototype,"querySelector"),overrideNodeMethod(HTMLElement.prototype,"querySelectorAll")}}(),function(){var BrahmaFactory,BrahmaFactory=function(userConfig){var factoryConfig={};if("object"==typeof userConfig)for(var i in userConfig)userConfig.hasOwnProperty(i)&&(factoryConfig[i]=userConfig[i]);var Brahma=null,currentQuerySelector="function"==typeof Sizzle?1:0;return Brahma=function(){if(this===window){var air=new Brahma;switch(arguments.length){case 1:var selector=arguments[0];switch(typeof selector){case"function":return Brahma.document.ready?selector.call(this):Brahma.bind("domReady",selector,!0),Brahma(window);default:var elements=Brahma.nodeQuery.call(this,selector)}break;case 0:var selector="",elements=Brahma.nodeQuery.call(this,selector)}if(("object"==typeof elements||"function"==typeof elements)&&elements.length)for(var index=0;index<elements.length;index++)air[index]=elements[index];return air.context=index>1?document:index>0?elements[0].parentNode:null,air.length=index,air.selector=selector,air}},Brahma.vector=Brahma.prototype={constructor:Brahma},Brahma.vector.version="1.3.7",Brahma.vector.brahma=!0,Brahma.document={ready:!1},Brahma.bench=function(subject,args,tieback){var elements=[];if("object"==typeof subject)if(subject instanceof Array||subject instanceof Brahma||jQuery&&subject instanceof jQuery)for(var i=0;i<subject.length;i++)elements.push(subject[i]);else for(var i in subject)subject.hasOwnProperty(i)&&(elements[i]=subject[i]);else elements=[subject];return tieback.call(subject,elements,args)},Brahma.nodeQuery=Brahma.vector.nodeQuery=function(query,root){var prefix;prefix=root?":scope ":"";var root=root||document;switch(typeof query){case"string":var queryExpr=/<([a-zA-Z0-9_]+) \/>/i,argsExpr=/\[([a-zA-Z0-9_\-]*)[ ]?=([ ]?[^\]]*)\]/i;if(query.indexOf("[")>-1&&argsExpr.exec(query)&&(query=query.replace(argsExpr,'[$1="$2"]')),null!==queryExpr.exec(query))return[document.createElement(result[1].toUpperCase())];if(0===query.length)return new Array;if(0===currentQuerySelector)try{return root.querySelectorAll(prefix+query)}catch(e){console.log("Brahma: querySelectorAll not support query: "+query)}else if(1===currentQuerySelector)return Sizzle(query,root);break;case"function":return[];case"object":if(query instanceof Array)return query;if(query==window)return[query];if(query.jquery){for(var elements=[],j=0;j<query.length;j++)elements.push(query[j]);return elements}if(query.brahma){for(var elements=[],j=0;j<query.length;j++)elements.push(query[j]);return elements}return[query];case"undefined":default:return[query]}},Brahma.camelCase=function(text){return text.replace(/-([\da-z])/gi,function(all,letter){return letter.toUpperCase()})},Brahma.ref=function(proto){function Ref(){}Ref.prototype=proto;var test=new Ref;return test},Brahma.copyProps=function(target,source){for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=source[prop]);return target},Brahma.inherit=function(proto){var o=Object.create(proto);for(var prop in proto)proto.hasOwnProperty(prop)&&null!==proto[prop]&&"object"==typeof proto[prop]&&(o[prop]="Ref"!==proto[prop].constructor.name?Brahma.clone(proto[prop]):proto[prop]);return o},Brahma.clone=function(prototype){if(prototype instanceof Array){var clone=[];clone.length=prototype.length}else var clone={};for(var prop in prototype)prototype.hasOwnProperty(prop)&&(clone[prop]=null===prototype[prop]||"object"!=typeof prototype[prop]||"Ref"===prototype[prop].constructor.name?prototype[prop]:Brahma.clone(prototype[prop]));return clone},Brahma.extend=function(){var target=arguments[0],proto=arguments[1],recrusive=arguments.length>2?arguments[2]:!1;for(var i in proto){if(!proto.hasOwnProperty(i))break;switch(typeof proto[i]){case"undefined":case"null":target[i]=null;break;case"object":if(proto[i]instanceof Array)target[i]=[],Brahma.extend(target[i],proto[i]);else if(recrusive)"object"!=typeof target[i]&&(target[i]={}),Brahma.exetnd(target[i],proto[i]);else{target[i]={};for(var ii in proto[i])target[i][ii]=proto[i][ii]}break;case"boolean":case"number":case"string":case"function":target[i]=proto[i]}}return target},Brahma.die=function(a){throw"Dharma error: "+(a||"unknown error")},(Brahma.classes={})&&(Brahma.classes.module={constructor:function(){var name,internals;"string"==typeof arguments[0]?(name=arguments[0],internals=arguments[1]||[]):(name=!1,internals=arguments[0]||[]);var module=Brahma.inherit(Brahma.classes.module.proto);if(module.master=this.ref(),internals instanceof Array)for(var i=0;i<internals.length;i++){if("object"!=typeof Brahma.classes.module.internals[internals[i]])return Brahma.error("There in no internal `"+internals[i]+"`");Brahma.extend(module,Brahma.classes.module.internals[internals[i]].proto),"function"==typeof Brahma.classes.module.internals[internals[i]].initial&&Brahma.classes.module.internals[internals[i]].initial.call(this.modules[name])}return module},proto:function(){var proto={};return proto.prototype={modules:{},assing:function(dist){return Brahma.extend(this,dist),this}},proto}(),internals:{tie:{proto:{tie:function(cb){return cb.apply(this,arguments),this}}},fabrics:{proto:{fabrics:{},modules:{},addFabric:function(name,internals,constructor,proto){return this.fabrics[name]={constructor:constructor||function(){},internals:internals,proto:proto||{}},this},create:function(fabricName,extend){var module=Brahma.industry.make("module",this.fabrics[fabricName].internals,this.fabrics[fabricName].proto);return Brahma.copyProps(module,extend),module.master=this.ref(),this.fabrics[fabricName].constructor.call(module),module},module:function(globalName){var initial="function"==typeof arguments[2]?arguments[2]:"function"==typeof arguments[1]?arguments[1]:!1,data="object"==typeof arguments[1]?arguments[1]:"object"==typeof arguments[2]?arguments[2]:!1;return data||initial?(this.addFabric(globalName,["events"],initial,data||{}),this):("undefined"==typeof this.modules[globalName]&&(this.modules[globalName]=this.create(globalName)),this.modules[globalName])}}},"interface":{proto:{"interface":{},setInterface:function(data){this["interface"]={};var that=this;for(var i in data)!function(name,f){"function"==typeof f&&(that["interface"][name]=function(){return f.apply(that,arguments)})}(i,data[i]["function"]);return this}}},visual:{proto:{createVisual:function(constructor){var proto={dom:{},objects:{}};if("function"==typeof constructor){var construct=constructor;construct.prototype=proto,construct.prototype.module=this,construct.prototype.constructor=constructor,this.visual=new construct(this)}else this.visual=Brahma.extend(proto,constructor);this.visual.module=this}}},events:{proto:{eventListners:{},bind:function(e,callback,once){var once=once;return"object"!=typeof this.eventListners[e]&&(this.eventListners[e]=[]),this.eventListners[e].push({callback:callback,once:once}),this},once:function(e,callback){return this.bind(e,callback,!0),this},trigger:function(){if("integer"==typeof arguments[0])var e=(arguments[0],arguments[1]),args=arguments.length>2?arguments[2]:[];else var e=arguments[0],args=arguments.length>1?arguments[1]:[];var response=!1;if("object"==typeof this.eventListners[e]&&this.eventListners[e].length>0){for(var todelete=[],i=0;i<this.eventListners[e].length;i++)"object"==typeof this.eventListners[e][i]&&("function"==typeof this.eventListners[e][i].callback&&(response=this.eventListners[e][i].callback.apply(this,args)),this.eventListners[e][i].once&&todelete.push(i));if(todelete.length>0)for(var i in todelete)this.eventListners[e].splice(todelete[i],1)}return response}}},controller:{proto:{controller:{},createController:function(a,b,c){var globalName,initial,data;if(arguments.length>2&&(globalName=a,initial=b,data=c),2==arguments.length&&(globalName=!1,initial=a,data=b),1==arguments.length&&(globalName=!1,initial=!1,data=a),"object"==typeof initial||"function"==typeof data){var x=initial;initial=data,data=x}return this.controller=Brahma.module(data||{}),this.controller.master=this,"function"==typeof initial&&initial.call(this.controller),globalName&&("object"!=typeof window.controllers&&(window.controllers={}),window.controllers[globalName]=this.controller),this.controller}}}}}),Brahma.extend(Brahma,Brahma.classes.module.internals.events.proto),Brahma.industry={make:function(className,internals,extend){var newObject=Brahma.classes[className].constructor.call(!1,internals||[]);if("object"==typeof extend)for(var i in extend)extend.hasOwnProperty(i)&&(newObject[i]="object"==typeof extend[i]?Brahma.inherit(extend[i]):extend[i]);return newObject}},Brahma.applications=Brahma.industry.make("module",["fabrics"]),Brahma.applications.addFabric("default",["events","fabrics"],function(){}),Brahma.app=Brahma.application=Brahma.vector.app=Brahma.vector.application=function(){if(this===window||"function"==typeof this){var name=arguments[0];if(arguments.length>1)switch(typeof arguments[1]){case"object":var $data=arguments[1];break;case"string":var copy=arguments[1];$data="undefined"!=typeof Brahma.applications.modules[copy]?Brahma.extend({},Brahma.applications.modules[copy]):{},arguments.length>2&&"object"==typeof arguments[2]&&($data=Brahma.extend($data,arguments[2]))}else $data={};if(name&&"undefined"!=typeof Brahma.applications.modules[name])return Brahma.extend(Brahma.applications.modules[name],$data);var component=Brahma.applications.create("default",$data);return"object"==typeof $data.config&&(component.config=Brahma.extend(component.config,$data.config)),Brahma.applications.modules[name]=component,name?Brahma.applications.modules[name]:this}if("object"!=typeof Brahma.applications.modules[arguments[0]])throw"Brahma: require `"+arguments[0]+"` application. Please, download it.";var options=arguments.length>1&&"object"==typeof arguments[1]?arguments[1]:{},plug=Brahma.inherit(Brahma.applications.modules[arguments[0]]);if(plug.config=Brahma.extend(plug.config,options,!0),plug.scope=plug.selector=this,plug.classname=arguments[0],Brahma(this)[0].component=plug,"function"==typeof arguments[2]&&arguments[2].apply(plug),"function"==typeof plug.run)var result=plug.run();return"undefined"==typeof result?plug:result},Brahma.application.run=function(appName){return Brahma(window).app(appName)},Brahma.vector.html=function(html){return"undefined"==typeof html?this.length<=0?null:this[0].innerHTML:Brahma.bench(this,arguments,function(elem){for(var q=0;q<elem.length;q++)elem[q].innerHTML=html;return this})},Brahma.vector.empty=function(){return Brahma.bench(this,arguments,function(elem){for(var q=0;q<elem.length;q++)elem[q].innerHTML="";return this})},Brahma.vector.remove=function(){return Brahma.bench(this,arguments,function(elem){for(var q=0;q<elem.length;q++)elem[q].parentNode.removeChild(elem[q]);return elem[q].parentNode})},Brahma.vector.replace=function(newElement,preserveData){return Brahma.bench(this,arguments,function(elem){for(var queue=[],i=0;i<elem.length;i++)!function(e){if(preserveData){var className=e.className,data={};if(Brahma.caniuse("dataset"))for(var d in e.dataset)e.dataset.hasOwnProperty(d)&&(data[d]=e.dataset[d]);else for(var d in e.attributes)e.attributes.hasOwnProperty(d)&&"data-"===e.attributes[d].name.substring(0,5)&&(data[e.attributes[d].name.substring(5)]=e.attributes[d].value)}if(queue.push(newElement.cloneNode()),e.parentNode.replaceChild(queue[queue.length-1],e),preserveData){if(Brahma.caniuse("dataset"))for(var d in data)queue[queue.length-1].dataset[d]=data[d];else for(var d in data)queue[queue.length-1].setAttribute("data-"+d,data[d]);queue[queue.length-1].className=className}}(elem[i]);return Brahma(queue)})},Brahma.vector.parent=function(){return Brahma.bench(this,arguments,function(elem){return elem.length>0?Brahma(elem[0].parentNode):null})},Brahma.vector.createNode=function(nodeName,attrs){var attrs=attrs||{};try{var newElement=document.createElement(nodeName)}catch(e){Brahma.die("Not a valid name tag name `"+nodeName+"`("+nodeName.length+")")}this[0].appendChild(newElement);for(var name in attrs)attrs.hasOwnProperty(name)&&newElement.setAttribute(name,attrs[name]);return Brahma([newElement])},Brahma.vector.each=Brahma.each=function(){var subject,callback;this instanceof Brahma?(subject=this,callback=arguments[0]||!1):(subject=arguments[0],callback=arguments[1]),Brahma.bench(subject,[callback],function(elements,args){for(var callback="function"==typeof args[0]?args[0]:!1,index=0;index<elements.length;index++)callback&&callback.call(elements[index],elements[index],index)})},Brahma.vector.put=function(){var kit=[];return Brahma.bench(this,arguments,function(elem,args){Brahma(elem).each(function(element){switch(typeof args[0]){case"object":var newElement=args[0];element.appendChild(newElement),kit.push(newElement);break;case"string":var nodeName=args[0].trim().toUpperCase(),attrs=args[1]||{},newElement=Brahma(element).createNode(nodeName,attrs)[0];kit.push(newElement)}})}),Brahma(kit)},Brahma.vector.and=function(){return Brahma.bench(this,arguments,function(elem,args){if(elem.length>0){var parent=Brahma(elem[0].parentNode);return parent.put.apply(parent,args)}return null})},Brahma.vector.condition=function(condit,onTrue,onFalse){return condit?"function"==typeof onTrue?onTrue.call(this,condit):this:"function"==typeof onFalse?onFalse.call(this):this},Brahma.vector.wrapAll=function(){return Brahma.bench(this,arguments,function(elem,args){for(var wrap=Brahma(elem[0].parentNode),node=wrap.createNode.apply(wrap,args),i=0;i<elem.length;i++)Brahma(node).put(elem[i]);return node})},Brahma.vector.find=function(){return Brahma.bench(this,arguments,function(elem,args){var kit=[];return Brahma.each(elem,function(){var founds=Brahma.nodeQuery(args[0],this);if(founds.length)for(var i=0;i<founds.length;i++)kit.push(founds[i])}),Brahma(kit)})},Brahma.vector.tie=function(cb){return cb.call(this),this},Brahma.addEvent=function(elem,type,eventHandle){null!=elem&&"undefined"!=typeof elem&&(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent?elem.attachEvent("on"+type,eventHandle):elem["on"+type]=eventHandle)},Brahma.vector.bind=function(){return Brahma.bench(this,arguments,function(elem,args){for(var i=0;i<elem.length;i++)Brahma.addEvent(elem[0],args[0],args[1]);return this})},Brahma.vector.addClass=function(){return Brahma.bench(this,arguments,function(elem,args){for(var stylename=args[0],i=0;i<elem.length;i++){var st=elem[i].className.split(" ");st.indexOf(stylename)<0&&(st.push(stylename),elem[i].className=st.join(" "))}return this})},Brahma.vector.removeClass=function(){return Brahma.bench(this,arguments,function(elem,args){for(var stylename=args[0],i=0;i<elem.length;i++){var st=elem[i].className.split(" "),index=st.indexOf(stylename);index>-1&&(st.splice(index,1),elem[i].className=st.join(" "))}return this})},Brahma.vector.hasClass=function(){return Brahma.bench(this,arguments,function(elem,args){for(var stylename=args[0],i=0;i<elem.length;i++){var st=elem[i].className.split(" "),index=st.indexOf(stylename);if(index>-1)return!0}return!1})},Brahma.vector.css=function(){var data,polymorph=[];return"object"==typeof arguments[0]?arguments[0]instanceof Array?(polymorph=arguments[0],data=arguments[1]):data=arguments[0]:arguments.length>1?(data={},data[arguments[0]]=arguments[1]):data=arguments[0],Brahma.bench(this,[polymorph,data],function(elem,args){return"object"==typeof args[1]?(Brahma(elem).each(function(){for(var i in data){if(0!==polymorph.length)for(var p=0;p<polymorph.length;p++)this.style[polymorph[p]+i]=data[i];this.style[i]=data[i]}}),Brahma(elem)):elem[0].style[data]})},Brahma.vector.data=function(){return Brahma.bench(this,arguments,function(elem,args){for(var key=Brahma.camelCase(args[0]),i=0;i<elem.length;i++){if(!(args.length>1))return Brahma.caniuse("dataset")?"undefined"!=typeof elem[i].dataset[key]?elem[i].dataset[key]:null:elem[i].getAttribute("data-"+args[0]);Brahma.caniuse("dataset")?elem[i].dataset[key]=args[1]:elem[i].setAttribute("data-"+args[0],args[1])}return this})},Brahma.vector.attr=function(){return Brahma.bench(this,arguments,function(elem,args){if(args.length>0){switch(typeof args[0]){case"object":Brahma(elem).each(function(){for(var i in args[0])this.setAttribute(i,args[0][i])});break;case"string":return args.length>1?(Brahma(elem).each(function(){this.setAttribute(args[0],args[1])}),this):elem[0].getAttribute(args[0]);default:return elem[0].attributes}return Brahma(elem)}return elem[0].attributes})},Brahma.vector.scroll=function(){var doc=document.documentElement,left=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0),top=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0);return{left:left,top:top}},Brahma.cultivate=function(){return BrahmaFactory(!1)},Brahma.caniuse=function(test){return Brahma.caniuse.info[test]&&"function"==typeof Brahma.caniuse.info[test]&&(Brahma.caniuse.info[test]=Brahma.caniuse.info[test]()),Brahma.caniuse.info[test]?Brahma.caniuse.info[test]:!1},Brahma.caniuse.info={dataset:"undefined"!=typeof document.createElement("div").dataset,translate3D:function(){for(var div=document.createElement("div"),ret=!1,properties=["perspectiveProperty","WebkitPerspective"],i=properties.length-1;i>=0;i--)ret=ret?ret:void 0!=div.style[properties[i]];if(ret){var st=document.createElement("style");st.textContent="@media (-webkit-transform-3d){#test3d{height:3px}}",document.getElementsByTagName("head")[0].appendChild(st),div.id="test3d",document.body.appendChild(div),ret=3===div.offsetHeight,st.parentNode.removeChild(st),div.parentNode.removeChild(div)}return ret},mobile:function(){for(var check=!1,i=0,iDevice=["iPad","iPhone","iPod"];i<iDevice.length;i++)if(navigator.platform===iDevice[i])return!0;return function(a){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)&&(check=!0)}(navigator.userAgent||navigator.vendor||window.opera),check}},function(win,fn){var done=!1,top=!0,doc=win.document,root=doc.documentElement,add=doc.addEventListener?"addEventListener":"attachEvent",rem=doc.addEventListener?"removeEventListener":"detachEvent",pre=doc.addEventListener?"":"on",init=function(e){("readystatechange"!=e.type||"complete"==doc.readyState)&&(("load"==e.type?win:doc)[rem](pre+e.type,init,!1),!done&&(done=!0)&&fn.call(win,e.type||e))},poll=function(){try{root.doScroll("left")}catch(e){return void setTimeout(poll,50)}init("poll")};if("complete"==doc.readyState)fn.call(win,"lazy");else{if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement}catch(e){}top&&poll()}doc[add](pre+"DOMContentLoaded",init,!1),doc[add](pre+"readystatechange",init,!1),win[add](pre+"load",init,!1)}}(window,function(){Brahma.document.ready=!0,Brahma.trigger("domReady")}),Brahma};window.Brahma=BrahmaFactory()}(),function(jQuery,Brahma){Object.defineProperty(jQuery.fn,"brahma",{get:function(){return console.log("getter",this),Brahma(this)}})}(jQuery,Brahma),Brahma.application("touch",{config:{minMoveX:5,minMoveY:5,simpleMoves:!1,preventDefaults:!0,preventDefaultsFunction:function(){return this.config.preventDefaults}},startX:null,isMoving:null,cancelTouch:function(){var component=this;this.selector[0].removeEventListener("touchmove",function(e){component.onTouchMove(e)}),this.startX=null,this.isMoving=!1},onTouchMove:function(e){var component=this;if(this.isMoving){var x=e.touches[0].pageX,y=e.touches[0].pageY,dx=this.startX-x,dy=this.startY-y,that=this,checkVerticalSwipe=function(){return!that.config.preventVerticalSwipe&&Math.abs(dx)<Math.abs(dy)?!0:!1};return component.trigger("wipe",[{dX:dx,dY:dy}]),Math.abs(dx)>=component.config.minMoveX?(component.config.simpleMoves&&component.cancelTouch(),dx>=0?component.trigger("swipeLeft",[{dX:dx,dY:dy}]):component.trigger("swipeRight",[{dX:dx,dY:dy}]),checkVerticalSwipe):Math.abs(dy)>=component.config.minMoveY?(component.config.simpleMoves&&component.cancelTouch(),dy>=0?component.trigger("swipeUp",[{dX:dx,dY:dy}]):component.trigger("swipeDown",[{dX:dx,dY:dy}]),checkVerticalSwipe):checkVerticalSwipe}},onTouchStart:function(e){var component=this;this.startX=e.touches[0].pageX,this.startY=e.touches[0].pageY,this.isMoving=!0,this.selector[0].addEventListener("touchmove",function(e){component.config.preventDefaults&&e.preventDefault(),component.onTouchMove(e)},!1)}}).run=function(){var component=this;return this.selector[0].addEventListener("touchstart",function(e){component.config.preventDefaultsFunction.call(component,e),component.onTouchStart(e)},!1),this.selector[0].addEventListener("touchend",function(e){component.trigger("throw",[e.target,e]),component.config.preventDefaultsFunction.call(component,e),component.cancelTouch()},!1),this},function($$){$$.app("screens",{config:{infinity:!1,lockDelay:!1,easing:"cubic-bezier(.43,.2,.46,.8)",duration:650,infinityMethod:"passage",touch:!0,autoFillImages:!0,deadlockEffect:!0,keyboard:!0,mobileMap:!1,debug:!1},data:{currentScreen:[0,0],shift:{x:0,y:0},advshift:{x:0,y:0},moving:0,movingStartTime:0,movingEndTime:0,maxX:0,maxY:0,minX:0,minY:0,locks:!1,arrowsStyle:""},modules:{},effects:{},grid:[],portalGrid:[],htmlelements:{},run:function(){var that=this;Brahma(this.selector).find(">*").wrapAll("div",{}),this.htmlelements.screensWrapper=Brahma(this.selector).find(">div"),Brahma(this.selector).addClass("brahma-widgets-screens"),Brahma(this.htmlelements.screensWrapper).find(">*").each(function(){var element=this;if(that.config.autoFillImages&&"img"===Brahma(element)[0].tagName.toLowerCase()){var src=Brahma(element).attr("src"),alt=Brahma(element).attr("alt")||src.replace("\\","/").split("/").reverse()[0];element=Brahma(element).replace(document.createElement("DIV"),!0).css({"background-image":'url("'+src+'")'}),Brahma(element).put("div",{"class":"brahma-widgets-screens-label"}).html(alt)}var xy=that.reserveCell(parseInt(Brahma(element).data("screens-x")),parseInt(Brahma(element).data("screens-y")),{node:element,arrowsStyle:Brahma(element).data("screens-arrows-style")||!1});Brahma(element).css({left:100*xy[0]+"%",top:100*xy[1]+"%"}),Brahma(element).hasClass("current")&&(that.data.currentScreen=xy)}),this.htmlelements.navigation=Brahma(this.selector).tie(function(){Brahma(this).put("div",{"class":"dharma-widgets-screens-navigation-up"}).tie(function(){that.htmlelements.navigation_up=this,Brahma(this).bind("click",function(){that.up()})}).and("div",{"class":"dharma-widgets-screens-navigation-down"}).tie(function(){that.htmlelements.navigation_down=this,Brahma(this).bind("click",function(){that.down()})}).and("div",{"class":"dharma-widgets-screens-navigation-left"}).tie(function(){that.htmlelements.navigation_left=this,Brahma(this).bind("click",function(){that.left()})}).and("div",{"class":"dharma-widgets-screens-navigation-right"}).tie(function(){that.htmlelements.navigation_right=this,Brahma(this).bind("click",function(){that.right()})})}),this.htmlelements.map=Brahma(this.selector).put("div",{"class":"dharma-widgets-screens-map"}),this.rebuildMap(),Brahma(this.htmlelements.screensWrapper).css(["-webkit-","-ms-","-o-","-moz-"],{"transition-duration":this.config.duration+"ms"}),Brahma(this.htmlelements.screensWrapper).css(["-webkit-","-ms-","-o-","-moz-"],{"transition-timing-function":this.config.easing}),this.config.keyboard&&this.module("keylistner").run(),this.config.infinity&&this.module("infinity").run(),this.config.touch&&this.module("touch"),Brahma.caniuse("mobile")&&this.config.mobileMap&&this.module("mobileMap"),this["goto"](this.data.currentScreen,!0)},up:function(){if(!this.canIMove())return!1;switch(this.canIMoveUp()){case!1:return this.module("edgeEffect").up();case 2:this.trigger("beforeMove",["up"]),this.modules.infinity.portalMove("up");break;case!0:this.trigger("beforeMove",["up"]),this["goto"]([this.data.currentScreen[0],this.data.currentScreen[1]-1])}},down:function(){if(!this.canIMove())return!1;switch(this.canIMoveDown()){case!1:return this.module("edgeEffect").down();case 2:this.trigger("beforeMove",["down"]),this.modules.infinity.portalMove("down");break;case!0:this.trigger("beforeMove",["down"]),this["goto"]([this.data.currentScreen[0],this.data.currentScreen[1]+1])}},left:function(){if(!this.canIMove())return!1;switch(this.canIMoveLeft()){case!1:return this.module("edgeEffect").left();case 2:this.trigger("beforeMove",["left"]),this.modules.infinity.portalMove("left");break;case!0:this.trigger("beforeMove",["left"]),this["goto"]([this.data.currentScreen[0]-1,this.data.currentScreen[1]])}},right:function(){if(!this.canIMove())return!1;switch(this.canIMoveRight()){case!1:return this.module("edgeEffect").right();case 2:this.trigger("beforeMove",["right"]),this.modules.infinity.portalMove("right");break;case!0:this.trigger("beforeMove",["right"]),this["goto"]([this.data.currentScreen[0]+1,this.data.currentScreen[1]])}},rebuildMap:function(){Brahma(this.htmlelements.map).empty();for(var that=this,y=0;y<this.grid.length;y++)"undefined"!=typeof this.grid[y]&&function(wrapper,layer){for(var x=0;x<layer.length;x++)!function(x,y){Brahma(wrapper).put("div",{"class":"screen-box-"+("undefined"==typeof layer[x]?"empty":"item"),"data-coords":y+"x"+x}).bind("click",function(){Brahma(this).hasClass("screen-box-item")&&that["goto"]([x,y])})}(x,y)}.call(this,Brahma(this.htmlelements.map).put("div",{"class":"screen-box-layer"}),this.grid[y])},navigationHide:function(thing){switch(thing){case"up":Brahma(this.htmlelements.navigation_up).addClass("hidden");break;case"down":Brahma(this.htmlelements.navigation_down).addClass("hidden");break;case"left":Brahma(this.htmlelements.navigation_left).addClass("hidden");break;case"right":Brahma(this.htmlelements.navigation_right).addClass("hidden")}},navigationShow:function(thing){switch(thing){case"up":Brahma(this.htmlelements.navigation_up).removeClass("hidden");break;case"down":Brahma(this.htmlelements.navigation_down).removeClass("hidden");break;case"left":Brahma(this.htmlelements.navigation_left).removeClass("hidden");break;case"right":Brahma(this.htmlelements.navigation_right).removeClass("hidden")}},getRealUpSlide:function(){switch(this.config.infinityMethod){case"passage":if(1===this.grid.length)return!1;if(this.config.infinity&&0===this.data.currentScreen[1]&&this.grid[this.data.maxY][this.data.currentScreen[0]])return 2;if(this.grid[this.data.currentScreen[1]-1]&&this.grid[this.data.currentScreen[1]-1][this.data.currentScreen[0]])break}},canIMoveUp:function(){return 1===this.grid.length?!1:this.config.infinity&&("discover"===this.config.infinityMethod&&(!this.grid[this.data.currentScreen[1]-1]||!this.grid[this.data.currentScreen[1]-1][this.data.currentScreen[0]])||0===this.data.currentScreen[1]&&this.grid[this.data.maxY][this.data.currentScreen[0]])?2:this.grid[this.data.currentScreen[1]-1]&&this.grid[this.data.currentScreen[1]-1][this.data.currentScreen[0]]?!0:!1},canIMoveDown:function(){return 1===this.grid.length?!1:this.config.infinity&&("discover"===this.config.infinityMethod&&(!this.grid[this.data.currentScreen[1]+1]||!this.grid[this.data.currentScreen[1]+1][this.data.currentScreen[0]])||this.data.currentScreen[1]===this.grid.length-1&&this.grid[0][this.data.currentScreen[0]])?2:this.grid[this.data.currentScreen[1]+1]&&this.grid[this.data.currentScreen[1]+1][this.data.currentScreen[0]]?!0:!1},canIMoveLeft:function(){return this.config.infinity&&"discover"===this.config.infinityMethod||1!==this.grid[this.data.currentScreen[1]].length?!this.grid[this.data.currentScreen[1]][this.data.currentScreen[0]-1]&&this.config.infinity&&("discover"===this.config.infinityMethod&&this.grid.length>1||0===this.data.currentScreen[0]&&this.grid[this.data.currentScreen[1]][this.data.maxX])?2:this.grid[this.data.currentScreen[1]][this.data.currentScreen[0]-1]?!0:!1:!1},canIMoveRight:function(){return this.config.infinity&&"discover"===this.config.infinityMethod||1!==this.grid[this.data.currentScreen[1]].length?!this.grid[this.data.currentScreen[1]][this.data.currentScreen[0]+1]&&this.config.infinity&&("discover"===this.config.infinityMethod&&this.grid.length>1||this.data.currentScreen[0]===this.grid[this.data.currentScreen[1]].length-1&&this.grid[this.data.currentScreen[1]][this.data.minX])?2:this.grid[this.data.currentScreen[1]][this.data.currentScreen[0]+1]?!0:!1:!1},canIMove:function(){return this.data.locks?!1:this.config.lockDelay===!0?this.data.moving?!1:!0:"number"==typeof this.config.lockDelay&&this.data.moving&&(new Date).getTime()-this.data.movingStartTime<this.config.lockDelay?!1:!0},getFirstXSlideByY:function(y){if(!this.grid[y])return!1;for(var x=0;x<this.grid[y].length;x++)if(this.grid[y][x])return x;return!1},getLastXSlideByY:function(y){if(!this.grid[y])return!1;for(var x=this.grid[y].length-1;x>=0;x--)if(this.grid[y][x])return x;return!1},getFirstYSlideByX:function(x){for(var y=0;y<this.grid.length;y++)if(this.grid[y]&&this.grid[y][x])return y;return!1},getLastYSlideByX:function(x){for(var y=this.grid.length-1;y>=0;y--)if(this.grid[y]&&this.grid[y][x])return y;return!1},shiftScreen:function(x,y,callback){var callback=callback||!1;Brahma(this.htmlelements.screensWrapper).css({top:-100*y+"%",left:-100*x+"%"}),"function"==typeof callback&&callback()},translate:function(x,y){var polytransform=["-webkit-","-ms-","-o-"],transform=Brahma.caniuse("translate3D")?"translate3D("+(x+100*this.data.shift.x+this.data.advshift.x)+"%,"+(y+100*this.data.shift.y+this.data.advshift.y)+"%,0)":"translateX("+(x+100*this.data.shift.x+this.data.advshift.x)+"%) translateY("+(y+100*this.data.shift.y+this.data.advshift.y)+"%)";Brahma(this.htmlelements.screensWrapper).css(polytransform,{"animation-play-state":"paused"}),Brahma(this.htmlelements.screensWrapper).css(polytransform,{transform:transform})},moveScreen:function(x,y,immediately,callback){var callback=callback||!1;if(immediately){Brahma(this.htmlelements.screensWrapper).addClass("noTransit");var that=this}var absx=-1*x,absy=-1*y;this.translate(100*absx,100*absy),immediately?setTimeout(function(){Brahma(that.htmlelements.screensWrapper).removeClass("noTransit"),"function"==typeof callback&&callback()},10):setTimeout(function(){"function"==typeof callback&&callback()},this.config.duration)},"goto":function(xy,immediately){if(!this.canIMove())return!1;this.data.currentScreen=xy,Brahma(this.htmlelements.screensWrapper).find(">*").removeClass("current"),Brahma(this.grid[xy[1]][xy[0]].node).addClass("current");var x=xy[0],y=xy[1];this.data.movingStartTime=(new Date).getTime(),this.data.moving++;var that=this;this.trigger("movingStart"),setTimeout(function(){that.grid[xy[1]][xy[0]].arrowsStyle!==that.data.arrowsStyle&&(Brahma(that.htmlelements.navigation_up).removeClass(that.data.arrowsStyle),Brahma(that.htmlelements.navigation_down).removeClass(that.data.arrowsStyle),Brahma(that.htmlelements.navigation_left).removeClass(that.data.arrowsStyle),Brahma(that.htmlelements.navigation_right).removeClass(that.data.arrowsStyle)),that.grid[xy[1]][xy[0]].arrowsStyle?(that.data.arrowsStyle=that.grid[xy[1]][xy[0]].arrowsStyle,Brahma(that.htmlelements.navigation_up).addClass(that.grid[xy[1]][xy[0]].arrowsStyle),Brahma(that.htmlelements.navigation_down).addClass(that.grid[xy[1]][xy[0]].arrowsStyle),
Brahma(that.htmlelements.navigation_left).addClass(that.grid[xy[1]][xy[0]].arrowsStyle),Brahma(that.htmlelements.navigation_right).addClass(that.grid[xy[1]][xy[0]].arrowsStyle)):that.data.arrowsStyle=""},this.config.duration/2),this.moveScreen(x,y,immediately||!1,function(){that.data.movingEndTime=(new Date).getTime(),that.data.moving--,that.trigger("movingEnd")}),this.canIMoveUp()?this.navigationShow("up"):this.navigationHide("up"),this.canIMoveDown()?this.navigationShow("down"):this.navigationHide("down"),this.canIMoveLeft()?this.navigationShow("left"):this.navigationHide("left"),this.canIMoveRight()?this.navigationShow("right"):this.navigationHide("right"),Brahma(this.htmlelements.map).find(">div>div").removeClass("current"),Brahma(this.htmlelements.map).find("div[data-coords="+y+"x"+x+"]").addClass("current")},reserveCell:function(x,y,data){if("undefined"!=typeof this.grid[y]&&"undefined"!=typeof this.grid[y][x])var xy=function(ox,oy){for(var y=0;y<this.grid.length;y++){if("undefined"==typeof this.grid[y])return[0,y];for(var x=0;x<this.grid[y].length;x++)if("undefined"==typeof this.grid[y][x])return[x,y]}return[ox,oy]}.call(this,x,y),x=xy[x],y=xy[y];return"undefined"==typeof this.grid[y]&&(this.grid[y]=[]),this.grid[y][x]=Brahma.extend({active:Brahma(data.node).hasClass("screen-box-item"),arrowsStyle:!1,onVisible:[]},data),this.trigger("gridAdds",[this.grid[y][x]]),y>this.data.maxY&&(this.data.maxY=y),x>this.data.maxX&&(this.data.maxX=x),x<this.data.minX&&(this.data.minX=x),y<this.data.minY&&(this.data.minY=y),[x,y]}})}(Brahma),Brahma.app("screens").module("touch",function(){this.listner=Brahma(this.master.selector[0]).app("touch",{simpleMoves:!0,minMoveX:30,minMoveY:30,preventDefaultEvents:!1});var that=this;this.listner.bind("swipeLeft",function(){that.master.right()}),this.listner.bind("swipeRight",function(){that.master.left()}),this.listner.bind("swipeUp",function(){that.master.down()}),this.listner.bind("swipeDown",function(){that.master.up()})},{listner:null}),Brahma.app("screens").module("keylistner",{run:function(){var that=this;Brahma(document).bind("keydown",function(e){switch(that.master.trigger("keydown",[e]),e.which){case 38:that.master.up();break;case 40:that.master.down();break;case 37:that.master.left();break;case 39:that.master.right()}})}}),Brahma.app("screens").module("preloader",{loadings:0,loadImage:function(src,first){var img=new Image,that=this;img.onload=img.onerror=function(){that.loaded()},img.src=src,first&&this.master.trigger("firstimginit",[img])},loaded:function(){this.loadings--,0===this.loadings&&this.done()},done:function(){Brahma(this.master.meta.slides[0].node).css("position","absolute"),this.master.module("slideshow").resume()},run:function(){this.master.module("slideshow").pause();for(var i=1;i<this.master.meta.slides.length;i++)Brahma(this.master.meta.slides[i].node).css("opacity",0);Brahma(this.master.meta.slides[0].node).css("position","static"),this.master.config.adjustContainerHeight&&Brahma(this.master.selector).css({height:"auto"}),this.loadings=0;for(var images=[],that=this,i=0;i<this.master.meta.slides.length;i++)Brahma(this.master.meta.slides[i].node).is("img")?(images.push(Brahma(this.master.meta.slides[i].node).attr("src")),that.loadings++):Brahma(this.master.meta.slides[i].node).find("img").each(function(){images.push(Brahma(this).attr("src")),that.loadings++});for(var i=0;i<images.length;i++)this.loadImage(images[i],0===i)}}),Brahma.app("screens").module("edgeEffect",{mod:function(coord,direct){if(!this.master.config.deadlockEffect||this.master.data.moving)return!1;this.master.data.advshift[coord]=25*direct,this.master.translate(-100*this.master.data.currentScreen[0],-100*this.master.data.currentScreen[1]);var that=this;return setTimeout(function(){that.master.data.advshift[coord]=0,that.master.translate(-100*that.master.data.currentScreen[0],-100*that.master.data.currentScreen[1])},100),!1},up:function(){return this.mod("y",1)},down:function(){return this.mod("y",-1)},left:function(){return this.mod("x",1)},right:function(){return this.mod("x",-1)}}),Brahma.app("screens").module("mobileMap",function(){var that=this;Brahma(this.master.htmlelements.map).addClass("mobile"),this.master.bind("movingStart",function(){that.zoomMap()}),this.master.bind("movingEnd",function(){that.tryUnZoomMap()})},{zoomMap:function(){Brahma(this.master.htmlelements.map).addClass("visible")},tryUnZoomMap:function(){var that=this;setTimeout(function(){that.master.data.moving||that.unZoomMap()},150)},unZoomMap:function(){Brahma(this.master.htmlelements.map).removeClass("visible")}}),Brahma.app("screens").module("location",{},function(){}),Brahma.app("screens").module("infinity",{run:function(){this.master.htmlelements.phantom=!1,this.master.config.lockDelay===!1&&(this.master.config.lockDelay=!0)},portalMove:function(direction){var fakex,fakey,nextx,nexty;switch(direction){case"up":switch(this.master.config.infinityMethod){case"discover":fakey=this.master.getLastYSlideByX(this.master.data.currentScreen[0])+1,fakex=this.master.data.currentScreen[0],nexty=fakey-1,nextx=fakex;break;case"passage":fakey=this.master.grid.length,fakex=this.master.data.currentScreen[0],nexty=fakey-1,nextx=fakex}break;case"down":switch(this.master.config.infinityMethod){case"discover":fakey=this.master.getFirstYSlideByX(this.master.data.currentScreen[0])-1,fakex=this.master.data.currentScreen[0],nexty=fakey+1,nextx=fakex;break;case"passage":fakey=-1,fakex=this.master.data.currentScreen[0],nexty=0,nextx=fakex}break;case"left":switch(this.master.config.infinityMethod){case"discover":var nexty=this.master.data.currentScreen[1],nextx=!1,protect=66;do if(nexty<this.master.data.minY?nexty=this.master.data.maxY:nexty--,nextx=this.master.getLastXSlideByY(nexty),protect--,0>protect)return void alert("fuuuuck");while(nextx===!1);fakey=nexty,fakex=nextx+1,nexty=nexty,nextx=fakex-1;break;case"passage":fakey=this.master.data.currentScreen[1],fakex=this.master.grid[this.master.data.currentScreen[0]].length,nexty=0,nextx=fakex-1}break;case"right":switch(this.master.config.infinityMethod){case"discover":var nexty=this.master.data.currentScreen[1],nextx=!1,protect=66;do if(nexty>this.master.data.maxY?nexty=this.master.data.minY:nexty++,nextx=this.master.getFirstXSlideByY(nexty),protect--,0>protect)return void alert("fuuuuck");while(nextx===!1);fakey=nexty,fakex=nextx-1,nexty=nexty,nextx=fakex+1;break;case"passage":fakey=this.master.data.currentScreen[1],fakex=0,nexty=0,nextx=fakex+1}}this.master.portalGrid[fakex]&&this.master.portalGrid[fakex][fakey]?this.master.portalGrid[fakex][fakey].processed:this.createFakeSlide(fakex,fakey);var that=this;this.master.data.shift.x+=fakex-this.master.data.currentScreen[0],this.master.data.shift.y+=fakey-this.master.data.currentScreen[1],this.master.shiftScreen(this.master.data.shift.x,this.master.data.shift.y,function(){that.master["goto"]([nextx,nexty],!1,function(){that.master.portalGrid[fakex][fakey].processed=!1})})},createFakeSlide:function(fakex,fakey){"object"!=typeof this.master.portalGrid[fakex]&&(this.master.portalGrid[fakex]={}),this.master.portalGrid[fakex][fakey]={node:Brahma(this.master.htmlelements.screensWrapper).put(Brahma(this.master.grid[this.master.data.currentScreen[1]][this.master.data.currentScreen[0]].node).clone()).css({left:100*fakex+"%",top:100*fakey+"%"}).addClass("fake"),processed:!0}}});